<!DOCTYPE html>
<html lang="fr">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="stylesheet" href="/stationstyles.css" />
		<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
		
		<link rel="icon" href="/assets/favicon.png" type="image/x-icon" />
		<title>Châtelet - MobiFer</title>
		<meta name="description" content="Prochains passages, informations et sorties de la station Châtelet." />
		<meta name="theme-color" content="#0b0082" />
		<meta property="og:title" content="Châtelet - MobiFer" />
		<meta property="og:description" content="Prochains passages, informations et sorties de la station Châtelet." />
		<meta property="og:image" content=" https://upload.wikimedia.org/wikipedia/commons/thumb/8/83/Entr%C3%A9e_M%C3%A9tro_Ch%C3%A2telet_Paris_1.jpg/1280px-Entr%C3%A9e_M%C3%A9tro_Ch%C3%A2telet_Paris_1.jpg " />
	</head>
	<body>
		<a href="/" class="header"><h1>MobiFer</h1></a>
		<div class="searchbox">
			<div class="searchbtn" onclick="hidesearch()">
				<span class="integrated"><img src="/assets/icons/search.svg"></span>
			</div>
			<input type="search" class="stationinput" id="search" placeholder="Rechercher une station...">
		</div>
		<div class="box image-center" id="search-results" style="max-width: 700px !important;"></div>

		<div id="station-content">
			

			<div class="centered">
				<p class="centered"><strong>Station</strong><br>
				<span class="shadowed pictos"><span class="inseparable"><span class="integrated"><img src="/assets/icons/symbole_metro_RVB.svg" alt="Metro"></span><span class="integrated"><a href="/lines/m01.html"><img src="/assets/icons/metro_1_couleur_RVB.svg" alt="1"></a></span></span><span class="integrated"><a href="/lines/m04.html"><img src="/assets/icons/metro_4_couleur_RVB.svg" alt="4"></a></span><span class="integrated"><a href="/lines/m07.html"><img src="/assets/icons/metro_7_couleur_RVB.svg" alt="7"></a></span><span class="integrated"><a href="/lines/m11.html"><img src="/assets/icons/metro_11_couleur_RVB.svg" alt="11"></a></span><span class="integrated"><a href="/lines/m14.html"><img src="/assets/icons/metro_14_couleur_RVB.svg" alt="14"></a></span></span><br>
				<span class="centered terminus-box">Châtelet</span></p><p class="centered"><em>Cette station est en correspondance avec&nbsp;: <strong><a href="/stations.html?station=Chatelet-Les Halles">Châtelet–Les Halles</a></strong> <span class="inseparable"><span class="integrated"><img src="/assets/icons/symbole_RER_RVB.svg" alt="RER"></span><span class="integrated"><a href="/lines/rerA.html"><img src="/assets/icons/RER_A_couleur_RVB.svg" alt="A"></a></span></span><span class="integrated"><a href="/lines/rerB.html"><img src="/assets/icons/RER_B_couleur_RVB.svg" alt="B"></a></span><span class="integrated"><a href="/lines/rerD.html"><img src="/assets/icons/RER_D_couleur_RVB.svg" alt="D"></a></span></em></p><div class="row">
			<div class="item"><div style="break-inside: avoid;"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/83/Entr%C3%A9e_M%C3%A9tro_Ch%C3%A2telet_Paris_1.jpg/1280px-Entr%C3%A9e_M%C3%A9tro_Ch%C3%A2telet_Paris_1.jpg" alt="Photo de la station" style="width: 100%; max-width: 800px; border-radius: 10px;" class="image-center"><div class="license">© Chabe01 sur <a href="https://commons.wikimedia.org/wiki/File:Entr%C3%A9e_M%C3%A9tro_Ch%C3%A2telet_Paris_1.jpg">Wikimedia Commons</a></div></div></div><div class="item">
				<div class="box image-center">
				<h2 class="centered">Accès</h2>
				<div class="centered"><span class="blue-box" style="padding: 10px !important; text-align: left;"><div class="sortie-row"><div class="sortie-left">
				<span class="num-sortie">10</span></div><div class="sortie-right"> place Sainte-Opportune <span style="font-size: 1.25em"> </span><br></div></div><div class="sortie-row"><div class="sortie-left">
				<span class="num-sortie">11</span></div><div class="sortie-right"> rue de Rivoli <span style="font-size: 1.25em"> </span><br></div></div><div class="sortie-row"><div class="sortie-left">
				<span class="num-sortie">12</span></div><div class="sortie-right"> rue Bertin Poirée <span style="font-size: 1.25em"> </span><br></div></div><div class="sortie-row"><div class="sortie-left">
				<span class="num-sortie">13</span></div><div class="sortie-right"> rue des Lavandières <span style="font-size: 1.25em"> </span><br></div></div><div class="sortie-row"><div class="sortie-left">
				<span class="num-sortie">14</span></div><div class="sortie-right"> rue Saint-Denis <span style="font-size: 1.25em"> </span><br></div></div><div class="sortie-row"><div class="sortie-left">
				<span class="num-sortie">15</span></div><div class="sortie-right"> Théâtre du Châtelet <span style="font-size: 1.25em"> </span><br></div></div><div class="sortie-row"><div class="sortie-left">
				<span class="num-sortie">16</span></div><div class="sortie-right"> place du Châtelet <span style="font-size: 1.25em"> <span class="integrated"><img src="/assets/icons/info.svg"></span><span class="integrated"><img src="/assets/icons/tickets.svg"></span></span><br></div></div><div class="sortie-row"><div class="sortie-left">
				<span class="num-sortie">17</span></div><div class="sortie-right"> Théâtre de la Ville <span style="font-size: 1.25em"> <span class="integrated"><img src="/assets/icons/info.svg"></span><span class="integrated"><img src="/assets/icons/tickets.svg"></span></span><br></div></div><div class="sortie-row"><div class="sortie-left">
				<span class="num-sortie">18</span></div><div class="sortie-right"> avenue Victoria <span style="font-size: 1.25em"> </span><br></div></div><div class="sortie-row"><div class="sortie-left">
				<span class="num-sortie">19</span></div><div class="sortie-right"> rue Saint-Martin <span style="font-size: 1.25em"> </span><br></div></div></span></div><div id="map"></div></div></div><div class="item">
			<div class="box image-center">
			<h2 class="centered">Statistiques et données</h2><table style="text-align: left;"><tr><td class="title" style= "width: 45%;">Ligne(s)</td><td style="font-size: 1.4em;"><span class="inseparable"><span class="integrated"><img src="/assets/icons/symbole_metro_RVB.svg" alt="Metro"></span><span class="integrated"><a href="/lines/m01.html"><img src="/assets/icons/metro_1_couleur_RVB.svg" alt="1"></a></span></span><span class="integrated"><a href="/lines/m04.html"><img src="/assets/icons/metro_4_couleur_RVB.svg" alt="4"></a></span><span class="integrated"><a href="/lines/m07.html"><img src="/assets/icons/metro_7_couleur_RVB.svg" alt="7"></a></span><span class="integrated"><a href="/lines/m11.html"><img src="/assets/icons/metro_11_couleur_RVB.svg" alt="11"></a></span><span class="integrated"><a href="/lines/m14.html"><img src="/assets/icons/metro_14_couleur_RVB.svg" alt="14"></a></span></td></tr><tr><td class="title">Ouverture</td><td style="font-weight: normal;">6 août 1900</td></tr><tr><td class="title">Nom inaugural</td><td style="font-weight: normal;">Pont Notre-Dame (ligne 7)</td></tr><tr><td class="title">Voies</td><td style="font-weight: normal;">11</td></tr><tr><td class="title">Quais</td><td style="font-weight: normal;">10</td></tr><tr><td class="title">Zone tarifaire</td><td style="font-weight: normal;">1</td></tr><tr><td class="title">Accessible</td><td style="font-weight: normal;">Oui (ligne 14 uniquement)</td></tr><tr><td class="title">Communes desservies</td><td style="font-weight: normal;">Paris (I<sup>er</sup>, IV<sup>e</sup>)</td></tr><tr><td class="title">Fréquentation</td><td style="font-weight: normal;">8,4 M voyageurs (2021)</td></tr></table></div></div><div class="item"><div class="box image-center"><h2 class="centered">Prochains passages <span class="integrated"><img src="/assets/icons/symbole_metro_RVB.svg" alt="Métro" title="Métro"></span> <div class="btn-group" title="Modifiez le style des SIEL"><button onclick="switchToPANAM();"><img src="/assets/icons/panam.svg" alt="PANAM" style="height: 1.25em;" id="panam"></button><button onclick="switchToPIQ();"><img src="/assets/icons/piq.svg" alt="PIQ" style="height: 1.25em;" id="piq"></button><button onclick="switchToPIQDark();"><img src="/assets/icons/piq.svg" alt="PIQ" style="height: 1.25em;" id="piq"> (sombre)</button></div></h2><div class="iframes-container"><div class="iframes"><div class="item"><iframe src="https://enrail.org/ratp/?style=panam&station=Ch%C3%A2telet&line=1&sens=La%20D%C3%A9fense&stationcode=42587&linecode=C01371&destcode=La%20D%C3%A9fense%20(Grande%20Arche)&destcodealt=false+&rivoli=false" class="ratp" frameborder="0"></iframe></div><div class="item"><iframe src="https://enrail.org/ratp/?style=panam&station=Ch%C3%A2telet&line=1&sens=Ch%C3%A2teau:b:de%20Vincennes&stationcode=42587&linecode=C01371&destcode=Ch%C3%A2teau%20de%20Vincennes&destcodealt=false+&rivoli=false" class="ratp" frameborder="0"></iframe></div><div class="item"><iframe src="https://enrail.org/ratp/?style=panam&station=Ch%C3%A2telet&line=4&sens=Porte%20de:b:Clignancourt&stationcode=42587&linecode=C01374&destcode=Porte%20de%20Clignancourt&destcodealt=false+&rivoli=false" class="ratp" frameborder="0"></iframe></div><div class="item"><iframe src="https://enrail.org/ratp/?style=panam&station=Ch%C3%A2telet&line=4&sens=Bagneux&stationcode=42587&linecode=C01374&destcode=BAGNEUX-LUCIE%20AUBRAC&destcodealt=false+&rivoli=false" class="ratp" frameborder="0"></iframe></div><div class="item"><iframe src="https://enrail.org/ratp/?style=siel&station=Ch%C3%A2telet&line=7&sens=La%20Courneuve&stationcode=42587&linecode=C01377&destcode=La%20Courneuve%20-%208%20Mai%201945&destcodealt=false+&rivoli=false" class="ratp" frameborder="0"></iframe></div><div class="item"><iframe src="https://enrail.org/ratp/?style=siel&station=Ch%C3%A2telet&line=7&sens=Ivry%20%E2%80%A2%20Villejuif&stationcode=42587&linecode=C01377&destcode=Mairie%20d%27Ivry%20%E2%80%A2%20Villejuif%20-%20Louis%20Aragon&destcodealt=false+&rivoli=false" class="ratp" frameborder="0"></iframe></div><div class="item"><iframe src="https://enrail.org/ratp/?style=panam&station=Ch%C3%A2telet&line=11&sens=Rosny:t:sous-Bois&stationcode=42587&linecode=C01381&destcode=Rosny-sous-Bois&destcodealt=false+&rivoli=false" class="ratp" frameborder="0"></iframe></div><div class="item"><iframe src="https://enrail.org/ratp/?style=panam&station=Ch%C3%A2telet&line=14&sens=Saint-Denis%20:l::s:Pleyel&stationcode=42587&linecode=C01384&destcode=Saint-Denis%20-%20Pleyel&destcodealt=false+&rivoli=false" class="ratp" frameborder="0"></iframe></div><div class="item"><iframe src="https://enrail.org/ratp/?style=panam&station=Ch%C3%A2telet&line=14&sens=A%C3%A9roport:b:d’Orly&stationcode=42587&linecode=C01384&destcode=A%C3%A9roport%20d%27Orly&destcodealt=false+&rivoli=false" class="ratp" frameborder="0"></iframe></div></div></div></div></div><div class="license">
				Reproductions des panneaux officiels proposées par <a href="https://enrail.org">enrail.org</a> (Métro), <a href="https://prochainstrains.arno.cl">Prochains Trains</a> (RER et Transilien) et MobiFer (Tramway)
				</div></div><div class="box image-center" id="stations-suivantes" style="max-width: 1500px !important;">
			<h2 class="centered">Stations suivantes</h2>
			<div id="prochains-arrets" style="width: 100%; display: flex; flex-wrap: wrap; justify-content: center; gap: 10px;">
				<div style="flex:1;">
				<table style="text-align:left; min-width:200px;">
					<tr>
						<td class="title" style="text-align:center;width:50%;">Direction</td>
						<td class="title" style="text-align:center;width:50%;"><span class="inseparable"><span class="integrated"><img src="/assets/icons/symbole_metro_RVB.svg" alt="Metro"></span><span class="integrated"><a href="/lines/m01.html"><img src="/assets/icons/metro_1_couleur_RVB.svg" alt="1"></a></span></span></td>
					</tr>
				
					<tr>
						<td class="title" style="text-align: right; width: 50%;">La Défense</td>
						<td><a href="/stations/Louvre-Rivoli">Louvre–Rivoli</a></td>
					</tr>
					<tr>
						<td class="title" style="text-align: right; width: 50%;">Château de Vincennes</td>
						<td><a href="/stations/Hotel de Ville">Hôtel de Ville</a></td>
					</tr></table></div>
				<div style="flex:1;">
				<table style="text-align:left; min-width:200px;">
					<tr>
						<td class="title" style="text-align:center;width:50%;">Direction</td>
						<td class="title" style="text-align:center;width:50%;"><span class="inseparable"><span class="integrated"><img src="/assets/icons/symbole_metro_RVB.svg" alt="Metro"></span><span class="integrated"><a href="/lines/m04.html"><img src="/assets/icons/metro_4_couleur_RVB.svg" alt="4"></a></span></span></td>
					</tr>
				
					<tr>
						<td class="title" style="text-align: right; width: 50%;">Porte de Clignancourt</td>
						<td><a href="/stations/Les Halles">Les Halles</a></td>
					</tr>
					<tr>
						<td class="title" style="text-align: right; width: 50%;">Bagneux–Lucie Aubrac</td>
						<td><a href="/stations/Cite">Cité</a></td>
					</tr></table></div>
				<div style="flex:1;">
				<table style="text-align:left; min-width:200px;">
					<tr>
						<td class="title" style="text-align:center;width:50%;">Direction</td>
						<td class="title" style="text-align:center;width:50%;"><span class="inseparable"><span class="integrated"><img src="/assets/icons/symbole_metro_RVB.svg" alt="Metro"></span><span class="integrated"><a href="/lines/m07.html"><img src="/assets/icons/metro_7_couleur_RVB.svg" alt="7"></a></span></span></td>
					</tr>
				
					<tr>
						<td class="title" style="text-align: right; width: 50%;">La Courneuve–8 Mai 1945</td>
						<td><a href="/stations/Pont Neuf">Pont Neuf</a></td>
					</tr>
					<tr>
						<td class="title" style="text-align: right; width: 50%;">Villejuif–Louis Aragon • Mairie d’Ivry</td>
						<td><a href="/stations/Pont Marie">Pont Marie</a></td>
					</tr></table></div>
				<div style="flex:1;">
				<table style="text-align:left; min-width:200px;">
					<tr>
						<td class="title" style="text-align:center;width:50%;">Direction</td>
						<td class="title" style="text-align:center;width:50%;"><span class="inseparable"><span class="integrated"><img src="/assets/icons/symbole_metro_RVB.svg" alt="Metro"></span><span class="integrated"><a href="/lines/m11.html"><img src="/assets/icons/metro_11_couleur_RVB.svg" alt="11"></a></span></span></td>
					</tr>
				
					<tr>
						<td class="title" style="text-align: right; width: 50%;">Châtelet</td>
						<td><a href="/stations/Terminus">Terminus</a></td>
					</tr>
					<tr>
						<td class="title" style="text-align: right; width: 50%;">Rosny–Bois-Perrier</td>
						<td><a href="/stations/Hotel de Ville">Hôtel de Ville</a></td>
					</tr></table></div>
				<div style="flex:1;">
				<table style="text-align:left; min-width:200px;">
					<tr>
						<td class="title" style="text-align:center;width:50%;">Direction</td>
						<td class="title" style="text-align:center;width:50%;"><span class="inseparable"><span class="integrated"><img src="/assets/icons/symbole_metro_RVB.svg" alt="Metro"></span><span class="integrated"><a href="/lines/m14.html"><img src="/assets/icons/metro_14_couleur_RVB.svg" alt="14"></a></span></span></td>
					</tr>
				
					<tr>
						<td class="title" style="text-align: right; width: 50%;">Saint-Denis–Pleyel</td>
						<td><a href="/stations/Pyramides">Pyramides</a></td>
					</tr>
					<tr>
						<td class="title" style="text-align: right; width: 50%;">Aéroport d’Orly</td>
						<td><a href="/stations/Gare de Lyon">Gare de Lyon</a></td>
					</tr></table></div></div></div>

		<div id="footer-container" style="padding-top: 10px;"></div>

		<script src="/addons/footer.js"></script>
		<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
		<script src="/assets/script/stationsearch.js" type="module"></script>
		<script src="/assets/script/searchandsiv.js"></script>
		<script type="module">
			const station2 = "Châtelet";
			setTimeout(() => {
				// Génération de la carte
				const map = L.map('map').setView([48.857, 2.350], 18);
				// Calque de tuiles (fond de carte)
				L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
					attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors | &copy; <a href="https://prim.iledefrance-mobilites.fr">Île-de-France Mobilités</a>',
					subdomains: 'abcd',
					maxZoom: 18,
					minZoom: 13
				}).addTo(map);

				let stationsMarkers = new L.FeatureGroup();
				let allStationFeatures = [];

				fetch('/data/stationsPositions.geojson')
					.then(response => response.json())
					.then(data => {
						allStationFeatures = data.features;

						// La carte doit être centrée sur la station de la page
						// On compare le nom de la station de la page (station.nom), normalisé, sans accent, avec les noms des stations de la carte
						const stationName = station2.normalize("NFD").replaceAll(/[\u0300-\u036f]/g, "").replaceAll("–", " ").replaceAll("-", " ").toLowerCase();
						const stationPosition = data.features.find(feature => feature.properties.zdaname.normalize("NFD").replaceAll(/[\u0300-\u036f]/g, "").replaceAll("–", "-").replaceAll("-", " ").toLowerCase() === stationName);
						if (stationPosition) {
							map.setView([stationPosition.geometry.coordinates[1], stationPosition.geometry.coordinates[0]], 17);
						} else {
							// Si la station n'est pas trouvée, on centre la carte sur Paris centre
							map.setView([48.857, 2.350], 17);
						}
					})
				.catch(err => console.error("Erreur de chargement du GeoJSON :", err));

				let accesMarkers = new L.FeatureGroup();
				let allFeatures = [];

				fetch('/data/acces.geojson')
					.then(response => response.json())
					.then(data => {
						allFeatures = data.features;
						updateVisiblePoints(); // Affiche les premiers points visibles
						map.on('moveend', updateVisiblePoints);
					})
				.catch(err => console.error("Erreur de chargement du GeoJSON :", err));

				function updateVisiblePoints() {
					const bounds = map.getBounds();
					
					// Filtre les points visibles
					const visible = allFeatures.filter(f => {
						const [lon, lat] = f.geometry.coordinates;
						return bounds.contains(L.latLng([lat, lon]));
					});

					const visibleStation = allStationFeatures.filter(f => {
						const [lon, lat] = f.geometry.coordinates;
						return bounds.contains(L.latLng([lat, lon]));
					});

					accesMarkers.clearLayers();
					stationsMarkers.clearLayers();

					const markers = L.geoJSON({ type: 'FeatureCollection', features: visible }, {
						pointToLayer: function (feature, latlng) {
							const numSortie = feature.properties.accshortname;
							const iconUrl = numSortie
							? `/assets/icons/sortie${numSortie}.svg`
							: `/assets/icons/sortie.svg`;

							return L.marker(latlng, {
								icon: L.icon({
									iconUrl: iconUrl,
									iconSize: [30, 30],
									iconAnchor: [0, 0],
									popupAnchor: [15, 0]
								})
							});
						},
						onEachFeature: function (feature, layer) {
							const shortName = feature.properties.accshortname ?? '';
							const name = feature.properties.accname?.replace("'", "’") ?? '';
							let html = `
								<div class="sortie-row">
								<div class="sortie-left"><span class="num-sortie"><strong>${shortName}</strong></span></div>
								<div class="sortie-right">${name}</div>
								</div>`;
							layer.bindPopup(html);
						}
					});

					accesMarkers.addLayer(markers);
					accesMarkers.addTo(map);

					if (map.getZoom() < 16) {
						map.removeLayer(accesMarkers);
					} else {
						map.addLayer(accesMarkers);
					}

					const stationMarkers = L.geoJSON({ type: 'FeatureCollection', features: visibleStation }, {
						pointToLayer: function (feature, latlng) {
							// Icone par défaut au cas où on rencontre un type inattendu
							let iconUrl = '/assets/icons/train_S_couleur_RVB.svg';

							// Règle l'icône selon le mode de transport qui dessert la station
							if (feature.properties.zdatype === "metroStation") {
							iconUrl = '/assets/icons/symbole_metro_RVB.svg';
							} else if (feature.properties.zdatype === "railStation") {
							iconUrl = '/assets/icons/symbole_train_RER_RVB.svg';
							} else if (feature.properties.zdatype === "onstreetTram") {
							iconUrl = '/assets/icons/symbole_tram_RVB.svg';
							}

							return L.marker(latlng, {
								icon: L.icon({
									iconUrl: iconUrl,
									iconSize: [40, 40],
									iconAnchor: [0, 0],
									popupAnchor: [20, 0]
								})
							});
						},
						onEachFeature: function (feature, layer) {
							layer.bindPopup(feature.properties.zdaname);
						}
					});

					stationsMarkers.addLayer(stationMarkers);
					stationsMarkers.addTo(map);
				}
			}, 1000);
		</script>
		<script>
			let slideIndex = 0;
			const slides = document.getElementsByClassName("slide");

			function showSlides(slide) {
				for (let i = 0; i < slides.length; i++) {
					slides[i].classList.remove("active");
				}

				slideIndex++;
				if (slideIndex > slides.length) { slideIndex = 1; }

				if (slides.length > 0) {
					slides[slideIndex - 1].classList.add("active");
				}

				setTimeout(showSlides, 3000); // or any interval you like
			}

			if (slides.length > 0) {
				showSlides();
			}
		</script>
	</body>
</html>
