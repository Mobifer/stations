<!DOCTYPE html>
<html lang="fr">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="stylesheet" href="/stationstyles.css" />
		
		<link rel="icon" href="/assets/favicon.png" type="image/x-icon" />
		<title>Gare de Lyon - MobiFer</title>
		<meta name="description" content="Plus d’informations sur la station Gare de Lyon sur MobiFer." />
		<meta name="theme-color" content="#0b0082" />
		<meta property="og:title" content="Gare de Lyon - MobiFer" />
		<meta property="og:description" content="Plus d’informations sur la station Gare de Lyon sur MobiFer." />
		<meta property="og:image" content="" />
	</head>
	<body>
		<a href="/" class="header"><h1>MobiFer</h1></a>
		<div class="searchbox">
			<div class="searchbtn" onclick="hidesearch()">
				<span class="integrated"><img src="/assets/icons/search.svg"></span>
			</div>
			<input type="search" class="stationinput" id="search" placeholder="Rechercher une station...">
		</div>
		<div class="box image-center" id="search-results" style="max-width: 700px !important;"></div>

		<div id="station-content">
			<div class="centered">
			<p class="centered"><strong>Station</strong><br>
			<span class="shadowed pictos"><span class="inseparable"><span class="integrated"><img src="/assets/icons/symbole_metro_RVB.svg" alt="Metro"></span><span class="integrated"><a href="/lines/m01.html"><img src="/assets/icons/metro_1_couleur_RVB.svg" alt="1"></a></span></span><span class="integrated"><a href="/lines/m14.html"><img src="/assets/icons/metro_14_couleur_RVB.svg" alt="14"></a></span> <span class="inseparable"><span class="integrated"><img src="/assets/icons/symbole_RER_RVB.svg" alt="RER"></span><span class="integrated"><a href="/lines/rerA.html"><img src="/assets/icons/RER_A_couleur_RVB.svg" alt="A"></a></span></span><span class="integrated"><a href="/lines/rerD.html"><img src="/assets/icons/RER_D_couleur_RVB.svg" alt="D"></a></span></span><br>
			<span class="centered terminus-box">Gare de Lyon</span>
			
			
			</p>

			
				<p class="centered"><em>Cette station est en correspondance avec&nbsp;: 
				
					<strong><a href="/stations/Paris-Gare de Lyon">Paris – Gare de Lyon</a></strong> <span class="inseparable"><span class="integrated"><img src="/assets/icons/symbole_train_RVB.svg" alt="Train"></span><span class="integrated"><a href="/lines/trainR.html"><img src="/assets/icons/train_R_couleur_RVB.svg" alt="R"></a></span></span>
					
				
				</em></p>
			

			<div class="row">
				<div class="item">
					<div style="break-inside: avoid;">
						
							<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/29/Gare_de_Lyon_%28Paris_métro%29_MP14_CA32_par_Cramos.JPG/1280px-Gare_de_Lyon_%28Paris_métro%29_MP14_CA32_par_Cramos.JPG" alt="Photo de la station" style="width: 100%; max-width: 800px; border-radius: 10px;" class="image-center">
							
								<div class="license">© Cramos sur <a href="https://commons.m.wikimedia.org/wiki/File:Gare_de_Lyon_(Paris_métro)_MP14_CA32_par_Cramos.JPG#mw-jump-to-license">Wikimedia Commons</a></div>
							
						                       
					</div>
				</div>

				<div class="item">
					<div class="box image-center">
						<h2 class="centered">Accès</h2>

						<div class="centered">
							<span class="blue-box" style="padding: 10px !important; text-align: left;">
								
								
									<div class="sortie-row">
										<div class="sortie-left">
											<span class="num-sortie">1</span>
										</div>
										<div class="sortie-right">
											
											
												boulevard Diderot
												<span style="font-size: 1.25em">
													
									
										<span class="integrated"><img src="/assets/icons/info.svg"></span>
										<span class="integrated"><img src="/assets/icons/tickets.svg"></span>
									
									
									
								
												</span><br>
											
											
											
										</div>
									</div>
								
									<div class="sortie-row">
										<div class="sortie-left">
											<span class="num-sortie">2</span>
										</div>
										<div class="sortie-right">
											
											
												Ministère de l’Économie et des Finances
												<span style="font-size: 1.25em">
													
									
									
									
										<span class="integrated"><img src="/assets/icons/escalator.svg"></span>
									
								
												</span><br>
											
											
											
										</div>
									</div>
								
									<div class="sortie-row">
										<div class="sortie-left">
											<span class="num-sortie">3</span>
										</div>
										<div class="sortie-right">
											
											
												rue Michel Chasles
												<span style="font-size: 1.25em">
													
									
									
									
										<span class="integrated"><img src="/assets/icons/escalator.svg"></span>
									
								
												</span><br>
											
											
											
										</div>
									</div>
								
									<div class="sortie-row">
										<div class="sortie-left">
											<span class="num-sortie">4</span>
										</div>
										<div class="sortie-right">
											
											
												cour Chalon
												<span style="font-size: 1.25em">
													
									
									
									
										<span class="integrated"><img src="/assets/icons/escalator.svg"></span>
									
								
												</span><br>
											
											
											
										</div>
									</div>
								
									<div class="sortie-row">
										<div class="sortie-left">
											<span class="num-sortie">6</span>
										</div>
										<div class="sortie-right">
											
											
												Tour de l’Horloge
												<span style="font-size: 1.25em">
													
									
									
									
										<span class="integrated"><img src="/assets/icons/escalator.svg"></span>
									
								
												</span><br>
											
											
											
										</div>
									</div>
								
									<div class="sortie-row">
										<div class="sortie-left">
											<span class="num-sortie">7</span>
										</div>
										<div class="sortie-right">
											
											
												rue de Bercy
												<span style="font-size: 1.25em">
													
									
									
									
								
												</span><br>
											
											
											
										</div>
									</div>
								
									<div class="sortie-row">
										<div class="sortie-left">
											<span class="num-sortie">9</span>
										</div>
										<div class="sortie-right">
											
											
												place Henri Frenay
												<span style="font-size: 1.25em">
													
									
									
									
								
												</span><br>
											
											
											
										</div>
									</div>
								
									<div class="sortie-row">
										<div class="sortie-left">
											<span class="num-sortie">10</span>
										</div>
										<div class="sortie-right">
											
											
												rue Legraverend
												<span style="font-size: 1.25em">
													
									
									
									
								
												</span><br>
											
											
											
										</div>
									</div>
								
									<div class="sortie-row">
										<div class="sortie-left">
											<span class="num-sortie">11</span>
										</div>
										<div class="sortie-right">
											
											
												rue de Chalon
												<span style="font-size: 1.25em">
													
									
									
									
								
												</span><br>
											
											
											
										</div>
									</div>
								
									<div class="sortie-row">
										<div class="sortie-left">
											<span class="num-sortie">12</span>
										</div>
										<div class="sortie-right">
											
											
												rue Villiot
												<span style="font-size: 1.25em">
													
									
									
									
										<span class="integrated"><img src="/assets/icons/escalator.svg"></span>
									
								
												</span><br>
											
											
											
										</div>
									</div>
								
									<div class="sortie-row">
										<div class="sortie-left">
											<span class="num-sortie">13</span>
										</div>
										<div class="sortie-right">
											
											
												rue Van Gogh
												<span style="font-size: 1.25em">
													
									
										<span class="integrated"><img src="/assets/icons/info.svg"></span>
										<span class="integrated"><img src="/assets/icons/tickets.svg"></span>
									
									
									
										<span class="integrated"><img src="/assets/icons/escalator.svg"></span>
									
								
												</span><br>
											
											
											
										</div>
									</div>
								
									<div class="sortie-row">
										<div class="sortie-left">
											<span class="num-sortie">15</span>
										</div>
										<div class="sortie-right">
											
											
												Maison de la RATP
												<span style="font-size: 1.25em">
													
									
									
										<span class="integrated"><img src="/assets/icons/ascenseur.svg"></span>
									
									
								
												</span><br>
											
											
											
										</div>
									</div>
								
							</span>
						</div>

						<div id="map"></div>
					</div>
				</div>

				<div class="item">
					<div class="box image-center">
						<h2 class="centered">Statistiques et données</h2>
						
							
							<table style="text-align: left;">
								
									<tr>
										<td class="title" style="width: 45%;">Ligne(s)</td>
										<td style="font-size: 1.4em;"><span class="inseparable"><span class="integrated"><img src="/assets/icons/symbole_metro_RVB.svg" alt="Metro"></span><span class="integrated"><a href="/lines/m01.html"><img src="/assets/icons/metro_1_couleur_RVB.svg" alt="1"></a></span></span><span class="integrated"><a href="/lines/m14.html"><img src="/assets/icons/metro_14_couleur_RVB.svg" alt="14"></a></span></td>
									</tr>
								
								
								
									
										<tr>
											<td class="title">Ouverture</td>
											<td style="font-weight: normal;">19 juillet 1900</td>
										</tr>
									
								
									
										<tr>
											<td class="title">Voies</td>
											<td style="font-weight: normal;">4</td>
										</tr>
									
								
									
										<tr>
											<td class="title">Quais</td>
											<td style="font-weight: normal;">3</td>
										</tr>
									
								
									
										<tr>
											<td class="title">Zone tarifaire</td>
											<td style="font-weight: normal;">1</td>
										</tr>
									
								
									
										<tr>
											<td class="title">Accessible</td>
											<td style="font-weight: normal;">Oui (ligne 14 uniquement)</td>
										</tr>
									
								
									
										<tr>
											<td class="title">Communes desservies</td>
											<td style="font-weight: normal;">Paris (XII<sup>e</sup>)</td>
										</tr>
									
								
									
										<tr>
											<td class="title">Fréquentation</td>
											<td style="font-weight: normal;">28,6 M voyageurs (2021)</td>
										</tr>
									
								
							</table>

							
								<br>
							
						
							
							<table style="text-align: left;">
								
									<tr>
										<td class="title" style="width: 45%;">Ligne(s)</td>
										<td style="font-size: 1.4em;"><span class="inseparable"><span class="integrated"><img src="/assets/icons/symbole_RER_RVB.svg" alt="RER"></span><span class="integrated"><a href="/lines/rerA.html"><img src="/assets/icons/RER_A_couleur_RVB.svg" alt="A"></a></span></span><span class="integrated"><a href="/lines/rerD.html"><img src="/assets/icons/RER_D_couleur_RVB.svg" alt="D"></a></span></td>
									</tr>
								
								
								
									
										<tr>
											<td class="title">Ouverture</td>
											<td style="font-weight: normal;">8 décembre 1977</td>
										</tr>
									
								
									
										<tr>
											<td class="title">Voies</td>
											<td style="font-weight: normal;">2 (RER A)<br>4 (RER D)</td>
										</tr>
									
								
									
										<tr>
											<td class="title">Quais</td>
											<td style="font-weight: normal;">1 (RER A)<br>2 (RER D)</td>
										</tr>
									
								
									
										<tr>
											<td class="title">Zone tarifaire</td>
											<td style="font-weight: normal;">1</td>
										</tr>
									
								
									
										<tr>
											<td class="title">Accessible</td>
											<td style="font-weight: normal;">Oui</td>
										</tr>
									
								
									
										<tr>
											<td class="title">Communes desservies</td>
											<td style="font-weight: normal;">Paris (XII<sup>e</sup>)</td>
										</tr>
									
								
									
										<tr>
											<td class="title">Fréquentation</td>
											<td style="font-weight: normal;">148,1 M voyageurs (2018)</td>
										</tr>
									
								
							</table>

							
						
					</div>
				</div>

				
					
					
						

							<div class="item">
								<div class="box image-center">
									<h2 class="centered">Prochains passages <span class="integrated"><img src="/assets/icons/symbole_metro_RVB.svg" alt="Métro" title="Métro"></span> <div class="btn-group" title="Modifiez le style des SIEL"><button onclick="switchToPANAM();"><img src="/assets/icons/panam.svg" alt="PANAM" style="height: 1.25em;" id="panam"></button><button onclick="switchToPIQ();"><img src="/assets/icons/piq.svg" alt="PIQ" style="height: 1.25em;" id="piq"></button><button onclick="switchToPIQDark();"><img src="/assets/icons/piq.svg" alt="PIQ" style="height: 1.25em;" id="piq"> (sombre)</button></div></h2>
									
										<div class="iframes-container">
											<div class="iframes">
									
									
										
											<div class="item">
												<iframe src="https://enrail.org/ratp/?style=panam&amp;station=Gare%20de%20Lyon&amp;line=1&amp;sens=La%20Défense&amp;stationcode=43153&amp;linecode=C01371&amp;destcode=La%20Défense%20(Grande%20Arche)&amp;destcodealt=false+&rivoli=false" class="ratp" frameborder="0"></iframe>
											</div>
										
										
										
									
										
											<div class="item">
												<iframe src="https://enrail.org/ratp/?style=panam&amp;station=Gare%20de%20Lyon&amp;line=1&amp;sens=Château:b:de%20Vincennes&amp;stationcode=43153&amp;linecode=C01371&amp;destcode=Château%20de%20Vincennes&amp;destcodealt=false+&rivoli=false" class="ratp" frameborder="0"></iframe>
											</div>
										
										
										
									
										
											<div class="item">
												<iframe src="https://enrail.org/ratp/?style=panam&amp;station=Gare%20de%20Lyon&amp;line=14&amp;sens=Saint-Denis%20:l::s:Pleyel&amp;stationcode=73626&amp;linecode=C01384&amp;destcode=Saint-Denis%20-%20Pleyel&amp;destcodealt=false+&rivoli=false" class="ratp" frameborder="0"></iframe>
											</div>
										
										
										
									
										
											<div class="item">
												<iframe src="https://enrail.org/ratp/?style=panam&amp;station=Gare%20de%20Lyon&amp;line=14&amp;sens=A%C3%A9roport:b:d’Orly&amp;stationcode=73626&amp;linecode=C01384&amp;destcode=A%C3%A9roport%20d%27Orly&amp;destcodealt=false+&rivoli=false" class="ratp" frameborder="0"></iframe>
											</div>
										
										
										
									
									
											</div>
										</div>
									
								</div>
							</div>
						
					
						

							<div class="item">
								<div class="box image-center">
									<h2 class="centered">Prochains passages <span class="integrated" style="margin-right: 0px !important;"><img src="/assets/icons/symbole_RER_RVB.svg" alt="RER" title="RER"></span> et <span class="integrated"><img src="/assets/icons/symbole_train_RVB.svg" alt="Transilien" title="Transilien"></span></h2>
									
									
										
										
											<iframe src="https://departs.leon.gp/screen/ratp_rer/stop/fr-idf:IDFM:73626/line/fr-idf:IDFM:C01742/pos/48.8434021,2.3763657" class="sncf" frameborder="0" scrolling="no"></iframe>
										
										
									
										
										
											<iframe src="https://iena.arno.cl/?aimedDepartureCount=5&amp;coordinates=48.8434021%2C2.3763657&amp;stop=stop_area%3AIDFM%3A73626&amp;lines=line%3AIDFM%3AC01728%2Cline%3AIDFM%3AC01852&amp;platforms=" class="sncf" frameborder="0" scrolling="no"></iframe>
										
										
									
									
								</div>
							</div>
						
					
						
					

					<div class="license">
						Reproductions des panneaux officiels proposées par 
						<a href="https://enrail.org">enrail.org</a> (Métro), 
						<a href="https://prochainstrains.arno.cl">Prochains Trains</a> (RER et Transilien) 
						et MobiFer (Tramway)
					</div>

				

				<div class="box image-center" id="stations-suivantes" style="max-width: 1500px !important; display: none;">
					<h2 class="centered">Stations suivantes</h2>
					<div id="prochains-arrets" style="width: 100%; display: flex; flex-wrap: wrap; justify-content: center; gap: 10px;"></div>
				</div>

			</div>
		</div>

		</div>
		
		<div id="footer-container" style="padding-top: 10px;"></div>

		<script src="/addons/footer.js"></script>
		<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
		<script src="/assets/script/stationsearch.js" type="module"></script>
		<script src="/assets/script/searchandsiv.js" type="module"></script>
		<script>
			const station = {"nom":"Gare de Lyon","corresp":["Paris-Gare de Lyon"],"lignes":{"metro":["1","14"],"rer":["A","D"]},"img":"https://upload.wikimedia.org/wikipedia/commons/thumb/2/29/Gare_de_Lyon_%28Paris_métro%29_MP14_CA32_par_Cramos.JPG/1280px-Gare_de_Lyon_%28Paris_métro%29_MP14_CA32_par_Cramos.JPG","imgp":"https://commons.m.wikimedia.org/wiki/File:Gare_de_Lyon_(Paris_métro)_MP14_CA32_par_Cramos.JPG#mw-jump-to-license","imga":"Cramos","stats":[{"lignes":{"metro":["1","14"]},"ouv":"19 juillet 1900","voies":"4","quais":"3","zt":"1","ufr":"Oui (ligne 14 uniquement)","communes":["Paris (XII<sup>e</sup>)"],"freq":"28,6 M voyageurs (2021)"},{"lignes":{"rer":["A","D"]},"ouv":"8 décembre 1977","voies":"2 (RER A)<br>4 (RER D)","quais":"1 (RER A)<br>2 (RER D)","zt":"1","ufr":"Oui","communes":["Paris (XII<sup>e</sup>)"],"freq":"148,1 M voyageurs (2018)"}],"sorties":[{"num":"1","desc":"boulevard Diderot","acc":true},{"num":"2","desc":"Ministère de l’Économie et des Finances","esc":true},{"num":"3","desc":"rue Michel Chasles","esc":true},{"num":"4","desc":"cour Chalon","esc":true},{"num":"6","desc":"Tour de l’Horloge","esc":true},{"num":"7","desc":"rue de Bercy"},{"num":"9","desc":"place Henri Frenay"},{"num":"10","desc":"rue Legraverend"},{"num":"11","desc":"rue de Chalon"},{"num":"12","desc":"rue Villiot","esc":true},{"num":"13","desc":"rue Van Gogh","acc":true,"esc":true},{"num":"15","desc":"Maison de la RATP","asc":true}],"siv":[{"metro":"https://enrail.org/ratp/?style=panam&station=Gare%20de%20Lyon&line=1&sens=La%20Défense&stationcode=43153&linecode=C01371&destcode=La%20Défense%20(Grande%20Arche)&destcodealt=false"},{"metro":"https://enrail.org/ratp/?style=panam&station=Gare%20de%20Lyon&line=1&sens=Château:b:de%20Vincennes&stationcode=43153&linecode=C01371&destcode=Château%20de%20Vincennes&destcodealt=false"},{"metro":"https://enrail.org/ratp/?style=panam&station=Gare%20de%20Lyon&line=14&sens=Saint-Denis%20:l::s:Pleyel&stationcode=73626&linecode=C01384&destcode=Saint-Denis%20-%20Pleyel&destcodealt=false"},{"metro":"https://enrail.org/ratp/?style=panam&station=Gare%20de%20Lyon&line=14&sens=A%C3%A9roport:b:d’Orly&stationcode=73626&linecode=C01384&destcode=A%C3%A9roport%20d%27Orly&destcodealt=false"},{"train":"https://departs.leon.gp/screen/ratp_rer/stop/fr-idf:IDFM:73626/line/fr-idf:IDFM:C01742/pos/48.8434021,2.3763657"},{"train":"https://iena.arno.cl/?aimedDepartureCount=5&coordinates=48.8434021%2C2.3763657&stop=stop_area%3AIDFM%3A73626&lines=line%3AIDFM%3AC01728%2Cline%3AIDFM%3AC01852&platforms="}]};

			// Génération de la liste des lignes (pour les stations suivantes)
			const lignesListe = [];
			const types = {
				metro: line => {
					if (line.endsWith("bis")) line = "0" + line.replace("bis", "b");
					return "m" + line.padStart(2, "0");
				},
				rer: line => "rer" + line,
				train: line => "train" + line,
				tram: line => {
					if (line.endsWith("a") || line.endsWith("b")) line = "0" + line;
					return "t" + line.padStart(2, "0");
				}
			};

			for (const [type, formatter] of Object.entries(types)) {
				const lignes = station.lignes[type];
				if (!Array.isArray(lignes)) continue;
				lignesListe.push(...lignes.map(formatter));
			};

		</script>
		<script>
			// Génération des arrêts suivants
			let prochainsArrets = {};
			let destinations = {};
			
			setTimeout(
				fetch('/data/metroliste.json')
					.then(response => response.json())
					.then(data => {
						const container = document.getElementById("prochains-arrets");
						let containerHTML = ``;

						lignesListe.forEach(ligne => {
							if (data[ligne]) {
								data[ligne].forEach(arret => {
									let stationAvantApres = [];
									let stationIndex = data[ligne].indexOf(arret);
									if (arret.constructor === Object) {
										if (arret.nom === station.nom) {
											// Si la station est un dictionnaire (dans une branche), on a directement le suivant et le prédécent
											stationAvantApres.push(arret.prec);
											stationAvantApres.push(arret.suiv);
											prochainsArrets[ligne] = stationAvantApres;
											destinations[ligne] = arret.terminus;
										}
									} else if (arret === station.nom) {
										// Si la station est "normale", on cherche le prédécent et le suivant
										// Attention aux stations précédant des stations en fourche !
										let avant = data[ligne][stationIndex - 1];
										let apres = data[ligne][stationIndex + 1];

										// Par exemple à Tolbiac, la station suivante sera Maison Blanche
										/* {
											"nom": "Maison Blanche",
											"prec": "Tolbiac",
											"suiv": ["Le Kremlin-Bicêtre", "Porte d’Italie"],
											"terminus": ["La Courneuve – 8 Mai 1945", ["Villejuif – Louis Aragon", "Mairie d’Ivry"]]
										} */ 
										
										if (avant.constructor === Object)
											avant = avant.nom;

										if (apres.constructor === Object)
											apres = apres.nom;
										
										stationAvantApres.push(avant);
										stationAvantApres.push(apres);
										prochainsArrets[ligne] = stationAvantApres;
									}
								});
							}
						})

						lignesListe.forEach(ligne => {
							if (prochainsArrets[ligne]?.length) {
								let precedent = prochainsArrets[ligne][0];
								let precedentId = [];
								let suivant = prochainsArrets[ligne][1];
								let suivantId = [];

								if (precedent != "Terminus" && !Array.isArray(precedent)) {
									precedentId = ["/stations.html?station=" + precedent.replaceAll(" \u2013 ", "-").replaceAll("\u2019", "").replaceAll(".", "").normalize("NFD").replaceAll(/[\u0300-\u036f]/g, "")];
								} else if (Array.isArray(precedent)) {
									precedent.forEach(station => {
										precedentId.push("/stations.html?station=" + station.replaceAll(" \u2013 ", "-").replaceAll("\u2019", "").replaceAll(".", "").normalize("NFD").replaceAll(/[\u0300-\u036f]/g, ""));
									})
								}

								if (suivant != "Terminus" && !Array.isArray(suivant)) {
									suivantId = ["/stations.html?station=" + suivant.replaceAll(" \u2013 ", "-").replaceAll("\u2019", "").replaceAll(".", "").normalize("NFD").replaceAll(/[\u0300-\u036f]/g, "")];
								} else if (Array.isArray(suivant)) {
									suivant.forEach(station => {
										suivantId.push("/stations.html?station=" + station.replaceAll(" \u2013 ", "-").replaceAll("\u2019", "").replaceAll(".", "").normalize("NFD").replaceAll(/[\u0300-\u036f]/g, ""));
									})
								}

								let pictos = ""; 

								if (ligne.startsWith("m")) {
									pictos = genererLignesHTML({ metro: [ligne.replace(/^m0?/, "").replace("b", "bis")] });
								}

								let terminusAller;
								let terminusRetour;

								if (destinations[ligne] && destinations[ligne].length > 0) {
									terminusAller = destinations[ligne][0];
									terminusRetour = destinations[ligne][1];
								} else {
									terminusAller = data[ligne][1];
									terminusRetour = data[ligne][data[ligne].length - 2];
								}

								// Crée un tableau pour les prochains arrêts
								containerHTML += `<div style="flex: 1;">`;
								containerHTML += `<table style="text-align: left; min-width: 200px;">`;
								// Ligne de titre
								containerHTML += `<tr><td class="title" style="font-size: 1.2em; text-align: center !important; width: 50%;">Direction</td><td class="title" style="font-size: 1.2em; text-align: center !important; width: 50%;">${pictos}</td></tr>`;

								if (Array.isArray(precedent)) {
									precedent.forEach((prec, i) => {
										containerHTML += `<tr><td class="title" style="width: 50%;">${terminusAller[precedent.indexOf(prec)]}</td><td><a href="${precedentId[i]}">${prec}</a></td></tr>`;
									});
								} else {
									if (Array.isArray(terminusAller))
										terminusAller = terminusAller.join(" • ");
									containerHTML += `<tr><td class="title" style="width: 50%;">${terminusAller}</td><td><a href="${precedentId}">${precedent}</a></td></tr>`;
								}
								
								if (Array.isArray(suivant)) {
									suivant.forEach((suiv, i) => {
										containerHTML += `<tr><td class="title">${terminusRetour[suivant.indexOf(suiv)]}</td><td><a href="${suivantId[i]}">${suiv}</a></td></tr>`;
									});
								} else {
									if (Array.isArray(terminusRetour))
										terminusRetour = terminusRetour.join(" • ");
									containerHTML += `<tr><td class="title">${terminusRetour}</td><td><a href="${suivantId}">${suivant}</a></td></tr>`;
								}

								containerHTML += `</table></div>`;
							}
						});

						if (containerHTML !== ``) {
							container.innerHTML = containerHTML.replaceAll(" \u2013 ", "\u2013");
							document.getElementById("stations-suivantes").style.display = "block";
						}
					})
				.catch(err => console.error("Erreur de chargement du JSON des stations dans l'ordre :", err)),
			500 );
		</script>
		<script>
			// Génération de la carte
			const map = L.map('map').setView([48.857, 2.350], 18);
			// Calque de tuiles (fond de carte)
			L.tileLayer('https://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png', {
				attribution: '&copy; OpenStreetMap France | &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors | &copy; <a href="https://prim.iledefrance-mobilites.fr">Île-de-France Mobilités</a>',
				subdomains: 'abcd',
				maxZoom: 18,
				minZoom: 13
			}).addTo(map);

			let stationsMarkers = new L.FeatureGroup();
			let allStationFeatures = [];

			fetch('/data/stationsPositions.geojson')
				.then(response => response.json())
				.then(data => {
					allStationFeatures = data.features;

					// La carte doit être centrée sur la station de la page
					// On compare le nom de la station de la page (station.nom), normalisé, sans accent, avec les noms des stations de la carte
					const stationName = station.nom.normalize("NFD").replaceAll(/[\u0300-\u036f]/g, "").replaceAll(" – ", " ").replaceAll("-", " ").toLowerCase();
					const stationPosition = data.features.find(feature => feature.properties.zdaname.normalize("NFD").replaceAll(/[\u0300-\u036f]/g, "").replaceAll(" – ", "-").replaceAll("-", " ").toLowerCase() === stationName);
					if (stationPosition) {
						map.setView([stationPosition.geometry.coordinates[1], stationPosition.geometry.coordinates[0]], 17);
					} else {
						// Si la station n'est pas trouvée, on centre la carte sur Paris centre
						map.setView([48.857, 2.350], 17);
					}
				})
			.catch(err => console.error("Erreur de chargement du GeoJSON :", err));

			let accesMarkers = new L.FeatureGroup();
			let allFeatures = [];

			fetch('/data/acces.geojson')
				.then(response => response.json())
				.then(data => {
					allFeatures = data.features;
					updateVisiblePoints(); // Affiche les premiers points visibles
					map.on('moveend', updateVisiblePoints);
				})
			.catch(err => console.error("Erreur de chargement du GeoJSON :", err));

			function updateVisiblePoints() {
				const bounds = map.getBounds();
				
				// Filtre les points visibles
				const visible = allFeatures.filter(f => {
					const [lon, lat] = f.geometry.coordinates;
					return bounds.contains(L.latLng([lat, lon]));
				});

				const visibleStation = allStationFeatures.filter(f => {
					const [lon, lat] = f.geometry.coordinates;
					return bounds.contains(L.latLng([lat, lon]));
				});

				accesMarkers.clearLayers();
				stationsMarkers.clearLayers();

				const markers = L.geoJSON({ type: 'FeatureCollection', features: visible }, {
					pointToLayer: function (feature, latlng) {
						return L.marker(latlng, {
							icon: L.icon({
								iconUrl: '/assets/icons/sortie.svg',
								iconSize: [30, 30],
								iconAnchor: [0, 0],
								popupAnchor: [15, 0]
							})
						});
					},
					onEachFeature: function (feature, layer) {
						const shortName = feature.properties.accshortname ?? '';
						const name = feature.properties.accname?.replace("'", "’") ?? '';
						let html = `
							<div class="sortie-row">
							<div class="sortie-left"><span class="num-sortie"><strong>${shortName}</strong></span></div>
							<div class="sortie-right">${name}</div>
							</div>`;
						layer.bindPopup(html);
					}
				});

				accesMarkers.addLayer(markers);
				accesMarkers.addTo(map);

				if (map.getZoom() < 16) {
					map.removeLayer(accesMarkers);
				} else {
					map.addLayer(accesMarkers);
				}

				const stationMarkers = L.geoJSON({ type: 'FeatureCollection', features: visibleStation }, {
					pointToLayer: function (feature, latlng) {
						// Icone par défaut au cas où on rencontre un type inattendu
						let iconUrl = '/assets/icons/train_S_couleur_RVB.svg';

						// Règle l'icône selon le mode de transport qui dessert la station
						if (feature.properties.zdatype === "metroStation") {
						iconUrl = '/assets/icons/symbole_metro_RVB.svg';
						} else if (feature.properties.zdatype === "railStation") {
						iconUrl = '/assets/icons/symbole_train_RER_RVB.svg';
						} else if (feature.properties.zdatype === "onstreetTram") {
						iconUrl = '/assets/icons/symbole_tram_RVB.svg';
						}

						return L.marker(latlng, {
							icon: L.icon({
								iconUrl: iconUrl,
								iconSize: [40, 40],
								iconAnchor: [0, 0],
								popupAnchor: [20, 0]
							})
						});
					},
					onEachFeature: function (feature, layer) {
						layer.bindPopup(feature.properties.zdaname);
					}
				});

				stationsMarkers.addLayer(stationMarkers);
				stationsMarkers.addTo(map);
			}

			setTimeout(() => map.invalidateSize(), 500);
		</script>
		<script src="/addons/footer.js"></script>
		<script>
			let slideIndex = 0;
			const slides = document.getElementsByClassName("slide");

			function showSlides(slide) {
				for (let i = 0; i < slides.length; i++) {
					slides[i].classList.remove("active");
				}

				slideIndex++;
				if (slideIndex > slides.length) { slideIndex = 1; }

				if (slides.length > 0) {
					slides[slideIndex - 1].classList.add("active");
				}

				setTimeout(showSlides, 3000); // or any interval you like
			}

			if (slides.length > 0) {
				showSlides();
			}
		</script>
	</body>
</html>
